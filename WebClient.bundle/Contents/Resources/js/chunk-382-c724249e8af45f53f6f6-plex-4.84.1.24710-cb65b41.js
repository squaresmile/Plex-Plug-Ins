"use strict";(self.webpackChunkplex_web_client=self.webpackChunkplex_web_client||[]).push([[382],{88740:function(t,e,n){var r;function o(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function i(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:o(t)}}var a="undefined"!=typeof window&&window===this?this:void 0!==n.g&&null!=n.g?n.g:this,s="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};function c(t,e){if(e){var n=a;t=t.split(".");for(var r=0;r<t.length-1;r++){var o=t[r];o in n||(n[o]={}),n=n[o]}(e=e(r=n[t=t[t.length-1]]))!=r&&null!=e&&s(n,t,{configurable:!0,writable:!0,value:e})}}function u(){u=function(){},a.Symbol||(a.Symbol=p)}function l(t,e){this.b=t,s(this,"description",{configurable:!0,writable:!0,value:e})}c("Promise",(function(t){function e(t){this.c=0,this.h=void 0,this.b=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.b=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.c=function(t){if(null==this.b){this.b=[];var e=this;this.f((function(){e.h()}))}this.b.push(t)};var o=a.setTimeout;n.prototype.f=function(t){o(t,0)},n.prototype.h=function(){for(;this.b&&this.b.length;){var t=this.b;this.b=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.g(t)}}}this.b=null},n.prototype.g=function(t){this.f((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.o),reject:t(this.g)}},e.prototype.o=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.m(t):this.i(t)}},e.prototype.m=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.A(e,t):this.i(t)},e.prototype.g=function(t){this.j(2,t)},e.prototype.i=function(t){this.j(1,t)},e.prototype.j=function(t,e){if(0!=this.c)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.c);this.c=t,this.h=e,this.l()},e.prototype.l=function(){if(null!=this.b){for(var t=0;t<this.b.length;++t)s.c(this.b[t]);this.b=null}};var s=new n;return e.prototype.s=function(t){var e=this.f();t.v(e.resolve,e.reject)},e.prototype.A=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{o(t(e))}catch(t){i(t)}}:e}var o,i,a=new e((function(t,e){o=t,i=e}));return this.v(r(t,o),r(n,i)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.v=function(t,e){function n(){switch(r.c){case 1:t(r.h);break;case 2:e(r.h);break;default:throw Error("Unexpected state: "+r.c)}}var r=this;null==this.b?s.c(n):this.b.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var o=i(t),a=o.next();!a.done;a=o.next())r(a.value).v(e,n)}))},e.all=function(t){var n=i(t),o=n.next();return o.done?r([]):new e((function(t,e){function i(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(o.value).v(i(a.length-1),e),o=n.next()}while(!o.done)}))},e})),l.prototype.toString=function(){return this.b};var f,p=(f=0,function t(e){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new l("jscomp_symbol_"+(e||"")+"_"+f++,e)});function d(){u();var t=a.Symbol.iterator;t||(t=a.Symbol.iterator=a.Symbol("Symbol.iterator")),"function"!=typeof Array.prototype[t]&&s(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return function(t){return d(),(t={next:t})[a.Symbol.iterator]=function(){return this},t}(o(this))}}),d=function(){}}function h(){this.g=!1,this.c=null,this.i=void 0,this.b=1,this.l=this.h=0,this.f=null}function b(t){if(t.g)throw new TypeError("Generator is already running");t.g=!0}function g(t,e){t.f={D:e,T:!0},t.b=t.h||t.l}function y(t,e,n){return t.b=n,{value:e}}function m(t){this.b=new h,this.c=t}function w(t,e,n,r){try{var o=e.call(t.b.c,n);if(!(o instanceof Object))throw new TypeError("Iterator result "+o+" is not an object");if(!o.done)return t.b.g=!1,o;var i=o.value}catch(e){return t.b.c=null,g(t.b,e),v(t)}return t.b.c=null,r.call(t.b,i),v(t)}function v(t){for(;t.b.b;)try{var e=t.c(t.b);if(e)return t.b.g=!1,{value:e.value,done:!1}}catch(e){t.b.i=void 0,g(t.b,e)}if(t.b.g=!1,t.b.f){if(e=t.b.f,t.b.f=null,e.T)throw e.D;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function S(t){this.next=function(e){return b(t.b),t.b.c?e=w(t,t.b.c.next,e,t.b.j):(t.b.j(e),e=v(t)),e},this.throw=function(e){return b(t.b),t.b.c?e=w(t,t.b.c.throw,e,t.b.j):(g(t.b,e),e=v(t)),e},this.return=function(e){return function(t,e){b(t.b);var n=t.b.c;return n?w(t,"return"in n?n.return:function(t){return{value:t,done:!0}},e,t.b.return):(t.b.return(e),v(t))}(t,e)},d(),this[Symbol.iterator]=function(){return this}}function O(t){return function(t){function e(e){return t.next(e)}function n(e){return t.throw(e)}return new Promise((function(r,o){!function t(i){i.done?r(i.value):Promise.resolve(i.value).then(e,n).then(t,o)}(t.next())}))}(new S(new m(t)))}function P(t,e){if(null==t)throw new TypeError("The 'this' value for String.prototype."+e+" must not be null or undefined");return t+""}h.prototype.j=function(t){this.i=t},h.prototype.return=function(t){this.f={return:t},this.b=this.l},c("Object.entries",(function(t){return t||function(t){var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push([e,t[e]]);return n}})),c("Array.from",(function(t){return t||function(t,e,n){e=null!=e?e:function(t){return t};var r=[],o="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];if("function"==typeof o){t=o.call(t);for(var i=0;!(o=t.next()).done;)r.push(e.call(n,o.value,i++))}else for(o=t.length,i=0;i<o;i++)r.push(e.call(n,t[i],i));return r}})),c("String.prototype.repeat",(function(t){return t||function(t){var e=P(this,"repeat");if(0>t||1342177279<t)throw new RangeError("Invalid count value");t|=0;for(var n="";t;)1&t&&(n+=e),(t>>>=1)&&(e+=e);return n}})),c("String.prototype.padStart",(function(t){return t||function(t,e){var n=P(this,"padStart");return t-=n.length,e=void 0!==e?String(e):" ",(0<t&&e?e.repeat(Math.ceil(t/e.length)).substring(0,t):"")+n}}));var R={PARSEC_OK:0,PARSEC_CONNECTING:20,PARSEC_WRN_BROWSER:30,CONNECT_WRN_APPROVAL:6,CONNECT_WRN_DECLINED:8,CONNECT_WRN_PEER_GONE:99,CONNECT_WRN_UNCONFIRMED:100,PARSEC_NOT_RUNNING:-3,WS_ERR_CONNECT:-6101,WS_ERR_CLOSE:-6105,NAT_ERR_WEBRTC:-6200};function E(t,e,n,r){return n=r?n.bind(r):n,t.addEventListener(e,n),[t,e,n]}function L(t){for(var e=(t=i(t)).next();!e.done;e=t.next())(e=e.value)[0].removeEventListener(e[1],e[2])}function C(t,e,n,r,o){(t=new DataView(t)).setInt32(0,n),t.setInt32(4,r),t.setInt32(8,o),t.setInt8(12,e)}function N(t,e,n,r){var o=new ArrayBuffer(13);return C(o,t,e,n,r),o}function _(t,e,n){var r=new ArrayBuffer(13+n.length+1);C(r,t,n.length+1,e,0),t=(new TextEncoder).encode(n),e=new Int8Array(r,13);for(var o=0;o<n.length;o++)e[o]=t[o];return r}var D={},B=1;function A(t){var e=B++;return D[e]=t,e}function T(t){var e=this;this.l=t,this.i=!1,this.j="",this.h=!1,this.b=this.sdp=null,this.c={},this.g=[],this.f=null,this.b=new RTCPeerConnection({iceServers:[{urls:"stun:stun.parsec.gg:3478"}]}),this.b.onicecandidate=function(t){t.candidate&&8<=(t=t.candidate.candidate.replace("candidate:","").split(" ")).length&&"udp"===t[2].toLowerCase()&&e.l(t[4],parseInt(t[5],10),!1,"srflx"===t[7],"host"===t[7])}}function j(t,e,n,r,o){t.c[n]=t.b.createDataChannel(e,{negotiated:!0,id:n}),t.c[n].binaryType="arraybuffer",t.c[n].onopen=r,t.c[n].onmessage=o}function I(t){for(;0<t.g.length;){var e=t.g.shift();t.b.addIceCandidate(new RTCIceCandidate({candidate:"candidate:2395300328 1 udp 2113937151 "+e.ip+" "+e.port+" typ "+(e.from_stun?"srflx":"host")+" generation 0 ufrag "+t.j+" network-cost 50",sdpMid:t.sdp.a.mid,sdpMLineIndex:0}))}}function k(t,e){this.c=e,this.g=t,this.f="",this.b=null,this.h=[],this.i=this.j=!1,this.timeout=null}function Z(t,e){t.b&&(e=JSON.stringify(e),t.b.readyState==WebSocket.OPEN?t.b.send(e):t.h.push(e))}T.prototype.close=function(){for(var t=i(Object.entries(this.c)),e=t.next();!e.done;e=t.next())e.value[1].close();this.b.close()},T.prototype.send=function(t,e){"open"==this.c[e].readyState&&this.c[e].send(t)},k.prototype.close=function(t){this.i=!0,this.b&&(this.b.close(t),this.b=null),this.timeout&&(clearTimeout(this.timeout),this.timeout=null)};var G=1e3/60/1e3,M=(/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)?200:100)/1e3;function x(t,e){t.playbackRate=e,t.play().catch((function(){}))}function U(t,e,n){var r=this;this.b=t,this.l=!0,this.type=e,this.o=n,this.f=this.c=null,this.m='video/mp4; codecs="avc1.64001e"'===this.type,this.g=[],this.j=[],this.h=null,this.i=0,this.A=function(){var t=r.b.seekable;if(t&&0<t.length){var e=(t=t.end(0))-r.b.currentTime;'video/mp4; codecs="avc1.64001e"'===r.type?(r.i=e>.025?r.i+1:0,60<r.i&&1==r.b.playbackRate?x(r.b,e>3*G?10:1.25):e<G&&1!=r.b.playbackRate&&x(r.b,1)):e>3*M?r.b.currentTime=t+1e3:e>1.5*M&&1==r.b.playbackRate?x(r.b,10):e<M&&10==r.b.playbackRate&&x(r.b,1)}}}function q(t){t.f=new MediaSource,t.b.src=URL.createObjectURL(t.f),t.b.load(),t.g.push(E(t.b,"error",(function(){console.error(t.b.error.message)}),null)),t.g.push(E(t.f,"sourceopen",(function(){t.c=t.f.addSourceBuffer(t.type),t.c.mode="sequence",t.g.push(E(t.c,"update",t.s,t)),t.b.play().catch((function(){})),t.h=setInterval(t.A,1)}),null))}function W(t){t.h&&clearInterval(t.h),t.b.pause(),L(t.g),t.f&&(t.c&&(t.f.removeSourceBuffer(t.c),t.c=null),t.f.endOfStream(),URL.revokeObjectURL(t.b.src),t.f=null),t.b.src="",'video/mp4; codecs="avc1.64001e"'===t.type&&t.b.load(),t.l=!0,t.m='video/mp4; codecs="avc1.64001e"'===t.type,t.g=[],t.j=[],t.h=null,t.i=0}function K(t,e){e=new Uint8Array(e),'audio/mp4; codecs="opus"'===t.type&&t.l&&(t.l=!1,q(t)),'video/mp4; codecs="avc1.64001e"'===t.type&&102===e[4]&&(W(t),q(t),t.m=!1),t.m||(t.j.push(e),t.s())}function F(t,e){var n=this;this.status=R.PARSEC_NOT_RUNNING,this.o=performance.now(),this.s={encodeLatency:0,decodeLatency:0,networkLatency:0},this.c=[],this.signal=this.b=null,this.h=[],this.g="",this.video=t,this.l=[],this.j={},this.m=0,this.i=new U(e,'audio/mp4; codecs="opus"',null),this.f=new U(t,'video/mp4; codecs="avc1.64001e"',(function(){console.warn("Attempting to recover stream..."),n.b&&n.b.send(N(13,0,0,1),0)})),this.h.push(E(window,"beforeunload",(function(){return n.B(),null}),null))}function X(t,e){if(t.signal&&t.status==R.PARSEC_CONNECTING){var n=t.signal;Z(n,{action:"offer_cancel",version:1,payload:{to:n.f,attempt_id:n.g}})}t.signal&&(t.signal.close(1e3),t.signal=null),e!=R.PARSEC_OK&&(t.b&&t.status==R.PARSEC_OK&&t.b.send(N(10,0,0,0),0),t.b&&(t.b.close(),t.b=null),W(t.f),W(t.i)),t.status=e,t.l=[],t.j={},t.m=0}U.prototype.s=function(){if(0<this.j.length&&this.c&&!this.c.updating)try{var t=this.j.shift();this.c.appendBuffer(t)}catch(t){console.warn(t),W(this),this.o&&this.o()}},(r=F.prototype).B=function(){L(this.h),this.C()},r.U=function(){},r.R=function(){return this.g},r.S=function(t){var e=D[t];return null!=e&&delete D[t],null==e?null:e},r.F=function(t,e,n){var r,o,i,a,s,c=this;return O((function(u){if(1==u.b)return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)?c.status!=R.PARSEC_NOT_RUNNING?u.return():(c.status=R.PARSEC_CONNECTING,D={},B=1,W(c.i),W(c.f),c.c=[],c.g=function(){for(var t=[],e=new Uint8Array(4),n=0;6>n;n++)crypto.getRandomValues(e),t.push(Array.from(e).map((function(t){return t.toString(16).padStart(2,"0")})).join(""));return t.join("-")}(),c.signal=new k(c.g,(function(t){X(c,t)})),r=function(t,e,n,r,o){if(c.signal){var i=c.signal;Z(i,{action:"candex",version:1,payload:{to:i.f,attempt_id:i.g,data:{ver_data:1,ip:t,port:e,lan:o,from_stun:r,sync:n}}})}},o=function(){c.h.push(E(document,"visibilitychange",(function(){document.hidden?(W(c.f),c.b&&c.b.send(N(19,0,0,0),0)):c.b&&c.b.send(N(13,0,0,0),0)}),null));var t=window.screen.width,e=window.screen.height;(800>t||600>e||1920<t||1080<e)&&(t=1920,e=1080),c.b&&c.b.send(function(t,e){return _(11,0,t=JSON.stringify({_version:1,_max_w:6e4,_max_h:6e4,_flags:0,resolutionX:t,resolutionY:e,refreshRate:60,mediaContainer:2}))}(t,e),0),X(c,R.PARSEC_OK)},c.b=new T(r),j(c.b,"control",0,o,(function(t){c.o=performance.now();var e=new DataView(t.data);switch((t={u:e.getInt32(0),w:e.getInt32(4),P:e.getInt32(8),type:e.getInt8(12)}).type){case 10:c.status=t.u;break;case 21:c.s={encodeLatency:parseFloat(t.w)/1e3,decodeLatency:0,networkLatency:0,packetsSent:0,fastRTs:0,slowRTs:0,bitrate:0};break;case 20:c.c.push({type:2,gamepadID:t.u,motorBig:t.w,motorSmall:t.P});break;case 16:c.c.push({type:t.u?4:5});break;case 28:c.m=t.u;break;case 17:c.c.push(function(t,e){return e=A(new Uint8Array(e.buffer,13,t.u)),{type:3,id:t.w,key:e}}(t,e));break;case 9:c.c.push(function(t){var e=t.getInt16(32),n=t.getInt32(16),r=0<n?new Uint8Array(t.buffer,34,n):null;return r=r?A(r):0,{type:1,cursor:{size:n,positionX:t.getInt16(24),positionY:t.getInt16(26),width:t.getInt16(20),height:t.getInt16(22),hotX:t.getInt16(28),hotY:t.getInt16(30),imageUpdate:0<r,relative:!!(256&e),hidden:!!(512&e),stream:0},key:r}}(e));break;case 25:e=JSON.parse(new TextDecoder("utf-8").decode(new Uint8Array(e.buffer,13,t.u-1)));for(var n={},r=0;r<e.length;r++)e[r].id==t.w&&(n=e[r]);t={list:e,me:n},c.l=t.list,c.j=t.me}})),j(c.b,"video",1,null,(function(t){K(c.f,t.data)})),j(c.b,"audio",2,null,(function(t){K(c.i,t.data)})),y(u,function(t){var e;return O((function(n){if(1==n.b)return e=t,y(n,t.b.createOffer(),2);e.f=n.i;for(var r=t.f.sdp.split("\n"),o={},i=0;i<r.length;i++){var a=r[i].split("="),s=a[0];a=a[1],s&&("a"===s?(o.a||(o.a={}),s=a.split(/:(.+)/),o.a[s[0]]=s[1]):o[s]=a)}return t.sdp=o,n.return({ice_ufrag:t.sdp.a["ice-ufrag"],ice_pwd:t.sdp.a["ice-pwd"],fingerprint:t.sdp.a.fingerprint})}))}(c.b),2)):(c.status=R.PARSEC_WRN_BROWSER,u.return());i=u.i,a=function(t,e,n){c.b&&function(t,e,n,r){var o,i;O((function(a){switch(a.b){case 1:if(!t.f)throw"Offer is not set";if(t.h){a.b=0;break}return t.j=e,y(a,t.b.setLocalDescription(t.f),3);case 3:a.h=4;var s=t.sdp.a.mid;return o="v=0\r\no=- "+function(){var t=new Uint8Array(16);return crypto.getRandomValues(t),t.map((function(t){return t%10})).join("")}()+" 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\na=group:BUNDLE "+s+"\r\na=msid-semantic: WMS *\r\nm=application 9 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\nb=AS:30\r\na=ice-ufrag:"+e+"\r\na=ice-pwd:"+n+"\r\na=ice-options:trickle\r\na=fingerprint:"+r+"\r\na=setup:active\r\na=mid:"+s+"\r\na=sendrecv\r\na=sctpmap:5000 webrtc-datachannel 256\r\na=max-message-size:1073741823\r\n",y(a,t.b.setRemoteDescription(new RTCSessionDescription({type:"answer",sdp:o})),6);case 6:a.b=5,a.h=0;break;case 4:a.h=0,s=a.f.D,a.f=null,i=s,console.log(i);case 5:t.i&&I(t),t.h=!0,a.b=0}}))}(c.b,t,e,n)},s=function(t,e,n,r){c.b&&function(t,e,n,r,o){r?(t.i=!0,setTimeout((function(){t.l("1.2.3.4",1234,!0,!1,!1)}),500)):t.g.push({ip:e.replace("::ffff:",""),port:n,from_stun:o}),t.h&&t.i&&I(t)}(c.b,t,e,n,r)},c.signal&&function(t,e,n,r,o,i,a){t.b=new WebSocket("wss://kessel-ws.parsecgaming.com:443/?session_id=_&role=client&version=1&sdk_version=0",e),t.f=n,t.b.onclose=function(){t.i||t.c(R.WS_ERR_CLOSE)},t.b.onerror=function(){t.c(R.WS_ERR_CONNECT)},t.b.onopen=function(){for(;0<t.h.length;)t.b.send(t.h.shift());Z(t,{action:"offer",version:1,payload:{to:t.f,attempt_id:t.g,secret:r||"",data:{ver_data:1,creds:o,mode:2,versions:{p2p:1,bud:1,init:1,video:1,audio:1,control:1}}}}),t.timeout=setTimeout((function(){t.c(R.CONNECT_WRN_APPROVAL)}),3e4)},t.b.onmessage=function(e){switch((e=JSON.parse(e.data)).action){case"answer_relay":if(t.j=!0,!e.payload.approved){t.c(R.CONNECT_WRN_DECLINED);break}t.timeout&&clearTimeout(t.timeout),t.timeout=setTimeout((function(){t.c(R.NAT_ERR_WEBRTC)}),1e4),e=e.payload.data.creds,i(e.ice_ufrag,e.ice_pwd,e.fingerprint);break;case"candex_relay":e=e.payload.data,a(e.ip,e.port,e.sync,e.from_stun);break;case"close":var n=R.WS_ERR_CLOSE;switch(e.payload.reason){case"HOST_NOT_FOUND":n=R.CONNECT_WRN_PEER_GONE;break;case"USER_UNCONFIRMED":n=R.CONNECT_WRN_UNCONFIRMED}t.c(n)}}}(c.signal,t,e,n,i,a,s),u.b=0}))},r.K=function(){return this.status},r.J=function(){return this.j},r.H=function(){return this.m},r.G=function(){return this.l},r.C=function(){X(this,R.PARSEC_NOT_RUNNING)},r.O=function(t,e){this.b&&this.status==R.PARSEC_OK&&this.b.send(_(17,t,e),0)},r.N=function(t){this.b&&this.status==R.PARSEC_OK&&this.b.send(function(t,e){switch(t.type){case 4:if(!t.relative){var n=e.videoWidth,r=e.videoHeight,o=Math.round(e.offsetWidth*window.devicePixelRatio),i=Math.round(e.offsetHeight*window.devicePixelRatio),a=Math.min(o/n,i/r);e=n*a,a*=r,i=Math.max((i-a)/2,0),(o=Math.round(n/e*(t.x-Math.max((o-e)/2,0))))===n-1&&(o=n),o>n&&(o=n),0>o&&(o=0),t.x=o,(n=Math.round(r/a*(t.y-i)))===r-1&&(n=r),n>r&&(n=r),0>n&&(n=0),t.y=n}return N(3,t.relative?1:0,t.x,t.y);case 8:return C(r=new ArrayBuffer(28),23,t.id,0,0),(n=new DataView(r)).setUint16(16,t.buttons),n.setInt16(18,t.thumbLX),n.setInt16(20,t.thumbLY),n.setInt16(22,t.thumbRX),n.setInt16(24,t.thumbRY),n.setUint8(26,t.leftTrigger),n.setUint8(27,t.rightTrigger),r;case 2:return N(1,t.button,t.pressed?1:0,0);case 1:return N(0,t.code,t.mod,t.pressed?1:0);case 3:return N(2,t.x,t.y,0);case 5:return N(4,t.button,t.pressed?1:0,t.id);case 6:return N(5,t.axis,t.value,t.id);case 7:return N(6,0,0,t.id);case 9:return N(24,0,0,0)}}(t,this.video),0)},r.M=function(){return this.c.shift()},r.I=function(){return this.s},r.L=function(){return this.status==R.PARSEC_OK&&5e3<performance.now()-this.o},F.prototype.destroy=F.prototype.B,F.prototype.setLogCallback=F.prototype.U,F.prototype.getAttemptID=F.prototype.R,F.prototype.getBuffer=F.prototype.S,F.prototype.clientConnect=F.prototype.F,F.prototype.clientGetStatus=F.prototype.K,F.prototype.clientGetSelf=F.prototype.J,F.prototype.clientGetHostMode=F.prototype.H,F.prototype.clientGetGuests=F.prototype.G,F.prototype.clientDisconnect=F.prototype.C,F.prototype.clientSendUserData=F.prototype.O,F.prototype.clientSendMessage=F.prototype.N,F.prototype.clientPollEvents=F.prototype.M,F.prototype.clientGetMetrics=F.prototype.I,F.prototype.clientNetworkFailure=F.prototype.L,F.prototype.Status=R,window.Parsec=F},8382:(t,e,n)=>{n.r(e),n.d(e,{default:()=>Jt});var r=n(9669),o=n.n(r),i=n(67294),a=n(86832),s=n(73788),c=n(75691),u=n(67956),l=(n(88740),(t=>(t[t.Keyboard=1]="Keyboard",t[t.MouseButton=2]="MouseButton",t[t.MouseWheel=3]="MouseWheel",t[t.MouseMotion=4]="MouseMotion",t[t.GamepadButton=5]="GamepadButton",t[t.GamepadAxis=6]="GamepadAxis",t[t.GamepadUnplug=7]="GamepadUnplug",t[t.GamepadState=8]="GamepadState",t[t.Release=9]="Release",t))(l||{})),f=(t=>(t[t.A=0]="A",t[t.B=1]="B",t[t.X=2]="X",t[t.Y=3]="Y",t[t.Back=4]="Back",t[t.Guide=5]="Guide",t[t.Start=6]="Start",t[t.LeftStick=7]="LeftStick",t[t.RightStick=8]="RightStick",t[t.LeftShoulder=9]="LeftShoulder",t[t.RightShoulder=10]="RightShoulder",t[t.DPadUp=11]="DPadUp",t[t.DPadDown=12]="DPadDown",t[t.DPadLeft=13]="DPadLeft",t[t.DPadRight=14]="DPadRight",t))(f||{}),p=(t=>(t[t.LeftX=0]="LeftX",t[t.LeftY=1]="LeftY",t[t.RightX=2]="RightX",t[t.RightY=3]="RightY",t[t.LeftTrigger=4]="LeftTrigger",t[t.RightTrigger=5]="RightTrigger",t))(p||{});function d(t){const e=new Map;return function(n,r){let o=r;o>0&&o<.3||o<0&&o>-.3?o=0:o>.85?o=1:o<-.85?o=-1:o>0?o-=.3:o<0&&(o+=.3),o<0?o*=32768:o>0&&(o*=32767),o=Math.round(o),t&&(o=t(o));const i=e.get(n)||0;if(!(Math.abs(o-i)<.1)||!o&&i)return e.set(n,o),o}}function h(t){const e=d((t=>t<0?-32768:t>0?32767:t));return(n,r)=>{const o=e(n,r);if(void 0!==o)return{axis:t,id:n,type:l.GamepadAxis,value:o}}}function b(t){const e=d();return(n,r)=>{const o=e(n,r);if(void 0!==o)return{axis:t,id:n,type:l.GamepadAxis,value:o}}}function g(t,e){const n=d();let r;return(o,i)=>{const a=n(o,i),s=0!==a;if(void 0===a)return;let c;if(a<0?c=t:a>0&&(c=e),s&&r===c)return;const u=[];return r&&r!==c&&u.push({button:r,id:o,pressed:!1,type:l.GamepadButton}),r=c,c&&u.push({button:c,id:o,pressed:s,type:l.GamepadButton}),u}}function y(t){return(e,n)=>({button:t,id:e,pressed:0!==n,type:l.GamepadButton})}const m={axes:{[u.pz.Axis0]:b(p.LeftX),[u.pz.Axis1]:b(p.LeftY),[u.pz.Axis2]:b(p.RightX),[u.pz.Axis3]:b(p.RightY)},buttons:{[u.Lw.Button0]:y(f.A),[u.Lw.Button1]:y(f.B),[u.Lw.Button2]:y(f.X),[u.Lw.Button3]:y(f.Y),[u.Lw.Button4]:y(f.LeftShoulder),[u.Lw.Button5]:y(f.RightShoulder),[u.Lw.Button6]:b(p.LeftTrigger),[u.Lw.Button7]:b(p.RightTrigger),[u.Lw.Button8]:y(f.Back),[u.Lw.Button9]:y(f.Start),[u.Lw.Button12]:y(f.DPadUp),[u.Lw.Button13]:y(f.DPadDown),[u.Lw.Button14]:y(f.DPadLeft),[u.Lw.Button15]:y(f.DPadRight)},keys:{[u.VD.KeyX]:y(f.A),[u.VD.KeyZ]:y(f.B),[u.VD.KeyS]:y(f.X),[u.VD.KeyA]:y(f.Y),[u.VD.KeyQ]:y(f.LeftShoulder),[u.VD.KeyW]:y(f.RightShoulder),[u.VD.ShiftRight]:y(f.Back),[u.VD.Enter]:y(f.Start),[u.VD.ArrowUp]:y(f.DPadUp),[u.VD.ArrowDown]:y(f.DPadDown),[u.VD.ArrowLeft]:y(f.DPadLeft),[u.VD.ArrowRight]:y(f.DPadRight)}},w={axes:{[u.pz.Axis0]:g(f.DPadLeft,f.DPadRight),[u.pz.Axis1]:g(f.DPadUp,f.DPadDown)},buttons:{[u.Lw.Button12]:y(f.DPadUp),[u.Lw.Button13]:y(f.DPadDown),[u.Lw.Button14]:y(f.DPadLeft),[u.Lw.Button15]:y(f.DPadRight)},keys:m.keys};var v=Object.defineProperty,S=Object.defineProperties,O=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertySymbols,R=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable,L=(t,e,n)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,C=(t,e)=>{for(var n in e||(e={}))R.call(e,n)&&L(t,n,e[n]);if(P)for(var n of P(e))E.call(e,n)&&L(t,n,e[n]);return t},N=(t,e)=>S(t,O(e));const _=N(C({},w),{buttons:N(C({},w.buttons),{[u.Lw.Button0]:y(f.A),[u.Lw.Button1]:y(f.B),[u.Lw.Button8]:y(f.Back),[u.Lw.Button9]:y(f.Start)})});var D=Object.defineProperty,B=Object.defineProperties,A=Object.getOwnPropertyDescriptors,T=Object.getOwnPropertySymbols,j=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,k=(t,e,n)=>e in t?D(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Z=(t,e)=>{for(var n in e||(e={}))j.call(e,n)&&k(t,n,e[n]);if(T)for(var n of T(e))I.call(e,n)&&k(t,n,e[n]);return t},G=(t,e)=>B(t,A(e));const M=G(Z({},w),{buttons:G(Z({},w.buttons),{[u.Lw.Button0]:y(f.B),[u.Lw.Button1]:y(f.A),[u.Lw.Button4]:y(f.LeftShoulder),[u.Lw.Button5]:y(f.RightShoulder),[u.Lw.Button8]:y(f.Back),[u.Lw.Button9]:y(f.Start)})});var x=Object.defineProperty,U=Object.defineProperties,q=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,K=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable,X=(t,e,n)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Y=(t,e)=>{for(var n in e||(e={}))K.call(e,n)&&X(t,n,e[n]);if(W)for(var n of W(e))F.call(e,n)&&X(t,n,e[n]);return t},V=(t,e)=>U(t,q(e));const z=V(Y({},w),{buttons:V(Y({},w.buttons),{[u.Lw.Button0]:y(f.B),[u.Lw.Button1]:y(f.A),[u.Lw.Button2]:y(f.Y),[u.Lw.Button3]:y(f.B),[u.Lw.Button9]:y(f.Start)})});var H=Object.defineProperty,J=Object.defineProperties,$=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertySymbols,tt=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable,nt=(t,e,n)=>e in t?H(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rt=(t,e)=>{for(var n in e||(e={}))tt.call(e,n)&&nt(t,n,e[n]);if(Q)for(var n of Q(e))et.call(e,n)&&nt(t,n,e[n]);return t},ot=(t,e)=>J(t,$(e));const it=ot(rt({},w),{axes:{[u.pz.Axis0]:b(p.LeftX),[u.pz.Axis1]:b(p.LeftY),[u.pz.Axis2]:h(p.RightX),[u.pz.Axis3]:h(p.RightY)},buttons:ot(rt({},w.buttons),{[u.Lw.Button0]:y(f.B),[u.Lw.Button2]:y(f.Y),[u.Lw.Button4]:y(f.LeftShoulder),[u.Lw.Button5]:y(f.RightShoulder),[u.Lw.Button6]:h(p.LeftTrigger),[u.Lw.Button7]:h(p.LeftTrigger),[u.Lw.Button9]:y(f.Start)})});var at=Object.defineProperty,st=Object.defineProperties,ct=Object.getOwnPropertyDescriptors,ut=Object.getOwnPropertySymbols,lt=Object.prototype.hasOwnProperty,ft=Object.prototype.propertyIsEnumerable,pt=(t,e,n)=>e in t?at(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dt=(t,e)=>{for(var n in e||(e={}))lt.call(e,n)&&pt(t,n,e[n]);if(ut)for(var n of ut(e))ft.call(e,n)&&pt(t,n,e[n]);return t},ht=(t,e)=>st(t,ct(e));const bt=ht(dt({},w),{buttons:ht(dt({},w.buttons),{[u.Lw.Button0]:y(f.B),[u.Lw.Button1]:y(f.A),[u.Lw.Button8]:y(f.Back),[u.Lw.Button9]:y(f.Start)})});var gt=Object.defineProperty,yt=Object.defineProperties,mt=Object.getOwnPropertyDescriptors,wt=Object.getOwnPropertySymbols,vt=Object.prototype.hasOwnProperty,St=Object.prototype.propertyIsEnumerable,Ot=(t,e,n)=>e in t?gt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pt=(t,e)=>{for(var n in e||(e={}))vt.call(e,n)&&Ot(t,n,e[n]);if(wt)for(var n of wt(e))St.call(e,n)&&Ot(t,n,e[n]);return t},Rt=(t,e)=>yt(t,mt(e));const Et=Rt(Pt({},w),{buttons:Rt(Pt({},w.buttons),{[u.Lw.Button0]:y(f.B),[u.Lw.Button1]:y(f.A),[u.Lw.Button9]:y(f.Start)})});var Lt=Object.defineProperty,Ct=Object.defineProperties,Nt=Object.getOwnPropertyDescriptors,_t=Object.getOwnPropertySymbols,Dt=Object.prototype.hasOwnProperty,Bt=Object.prototype.propertyIsEnumerable,At=(t,e,n)=>e in t?Lt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Tt=(t,e)=>{for(var n in e||(e={}))Dt.call(e,n)&&At(t,n,e[n]);if(_t)for(var n of _t(e))Bt.call(e,n)&&At(t,n,e[n]);return t},jt=(t,e)=>Ct(t,Nt(e));const It=jt(Tt({},w),{buttons:jt(Tt({},w.buttons),{[u.Lw.Button0]:y(f.B),[u.Lw.Button1]:y(f.A),[u.Lw.Button9]:y(f.B)})});var kt=Object.defineProperty,Zt=Object.defineProperties,Gt=Object.getOwnPropertyDescriptors,Mt=Object.getOwnPropertySymbols,xt=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable,qt=(t,e,n)=>e in t?kt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wt=(t,e)=>{for(var n in e||(e={}))xt.call(e,n)&&qt(t,n,e[n]);if(Mt)for(var n of Mt(e))Ut.call(e,n)&&qt(t,n,e[n]);return t},Kt=(t,e)=>Zt(t,Gt(e));const Ft=Kt(Wt({},w),{buttons:Kt(Wt({},w.buttons),{[u.Lw.Button0]:y(f.B),[u.Lw.Button1]:y(f.A),[u.Lw.Button2]:y(f.Y),[u.Lw.Button3]:y(f.X),[u.Lw.Button4]:y(f.LeftShoulder),[u.Lw.Button5]:y(f.RightShoulder),[u.Lw.Button8]:y(f.Back),[u.Lw.Button9]:y(f.Start)})});var Xt=n(1402),Yt=n(23645),Vt=n(83397);const zt=function({inputDevices:t,paused:e,peerID:n,platformTag:r,preventDefault:o,sessionID:c,style:l,volume:f,onConnected:p,onError:d,onPause:h}){const[b,g]=(0,i.useState)(null),[y,w]=(0,i.useState)(null),[v,S]=(0,i.useState)(null),O=(0,i.useCallback)((t=>{let e=null,n=null;if(t){const r=t.appendChild(document.createElement("video"));r.className="ParsecGame-mediaElement-f8ws2j HTMLMedia-mediaElement-u17S9P",n=t.appendChild(document.createElement("audio")),e=new window.Parsec(r,n,t)}w(n),S(e)}),[]);return(0,i.useEffect)((()=>()=>{v&&(v.destroy(),(0,a.Z)("[Game] Destroyed"))}),[v]),(0,i.useEffect)((()=>{if(!v||!n||!c)return;(0,a.Z)("[Game] Starting status monitor");let t=window.setInterval((()=>{g(v.clientGetStatus())}),250);return(0,a.Z)("[Game] Connecting..."),v.setLogCallback(a.Z),v.clientConnect(c,n),()=>{t&&((0,a.Z)("[Game] Stopping status monitor"),t=window.clearInterval(t)),v.clientGetStatus()!==v.Status.PARSEC_CONNECTING&&v.clientGetStatus()!==v.Status.PARSEC_OK||((0,a.Z)("[Game] Disconnecting..."),v.clientDisconnect())}}),[v,n,c]),(0,i.useEffect)((()=>{if(!v)return;const{Status:t}=v;if(p(b===t.PARSEC_OK),null!==b&&b!==t.PARSEC_CONNECTING&&b!==t.PARSEC_OK&&b!==t.PARSEC_NOT_RUNNING){const t=new Error(function(t,e){const{Status:n}=e;switch(t){case n.CONNECT_WRN_PEER_GONE:return(0,s.Z)("Unable to start game session.");case n.CONNECT_WRN_UNCONFIRMED:return(0,s.Z)("Please complete Parsec account email verification.");case n.NAT_ERR_WEBRTC:return(0,s.Z)("Network configuration prevents direct connection to game session.");default:return(0,s.Z)("A critical error occurred.")}}(b,v));t.category=function(t,e){const{Status:n}=e;switch(t){case n.CONNECT_WRN_UNCONFIRMED:return(0,s.Z)("Parsec Account");case n.CONNECT_WRN_PEER_GONE:return(0,s.Z)("Game Server");case n.NAT_ERR_WEBRTC:return(0,s.Z)("Network");default:return(0,s.Z)("Unknown")}}(b,v),t.code=String(b),a.Z.error("[Game] Fatal error!",t),a.Z.error("[Game] Disconnecting..."),v.clientDisconnect(),d(t)}}),[v,b,p,d]),(0,i.useEffect)((()=>{if(!v||b!==v.Status.PARSEC_OK)return;const t=e||o?u.Tk.PauseGame:u.Tk.ResumeGame;(0,a.Z)(`[Game] Sending data: ${t}`),v.clientSendUserData(t,"")}),[b,e,v,o]),(0,i.useEffect)((()=>{if(!v||b!==v.Status.PARSEC_OK||o)return;const e=function(t){switch(t){case"Atari 2600":case"Atari 7800":return _;case"Game Boy":case"Game Boy Color":case"Nintendo Entertainment System":return bt;case"Game Boy Advance":return M;case"Nintendo 64":return it;case"Super Nintendo Entertainment System":return Ft;case"Sega Master System":return It;case"Sega Game Gear":return Et;case"Sega 32X":case"Sega Genesis":return z;default:return m}}(r),n=t.findIndex((t=>t.type===u.MT.Keyboard)),i=(0,Yt.Z)(((t,r)=>{const o=e.keys[t];if(-1!==n&&o){const t=o(n,r?1:0);if(t){const e=Array.isArray(t)?t:[t];for(const t of e)v.clientSendMessage(t)}}}),(t=>t.key===Vt.Z.Escape)),a=(0,Xt.Z)(((n,r,o)=>{const i=t.findIndex((t=>t.index===n.index));if(-1!==i){for(const t of r.changed){const n=e.axes[t];if(n){const e=n(i,r.values.get(t));if(e){const t=Array.isArray(e)?e:[e];for(const e of t)v.clientSendMessage(e)}}}for(const t of o.changed){const n=e.buttons[t];if(n){const e=n(i,o.values.get(t));if(e){const t=Array.isArray(e)?e:[e];for(const e of t)v.clientSendMessage(e)}}}}}));return()=>{i(),a()}}),[b,t,v,r,o]),(0,i.useEffect)((()=>{y&&(y.volume=Math.max(0,Math.min(f/100,1)))}),[y,f]),(0,i.useEffect)((()=>{if(!v)return;const t=()=>{v.clientGetStatus()===v.Status.PARSEC_OK&&v.clientSendUserData(u.Tk.PauseGame,"")},e=()=>{"hidden"===document.visibilityState&&h&&h()};return window.addEventListener("unload",t,!1),document.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("unload",t,!1),document.removeEventListener("visibilitychange",e,!1)}}),[v,h]),i.createElement("div",{ref:O,style:l})};function Ht({edgeGutterX:t,edgeGutterY:e,gameInputDevices:n,gamePlatformTag:r,gamePreventDefault:l,height:f,isStackedAbove:p,paused:d,placement:h,positionSeconds:b,src:g,volume:y,width:m,onDurationMillisecondsChange:w,onPause:v,onPositionMillisecondsChange:S,onError:O,onTick:P}){const R=(0,i.useRef)(1e3*b),[E,L]=(0,i.useState)(null),[C,N]=(0,i.useState)(null),[_,D]=(0,i.useState)(!1);(0,i.useEffect)((()=>{const t=o().CancelToken.source(),e=Date.now();return(0,a.Z)("[Game] Fetching session identifiers..."),o().get(g,{cancelToken:t.token}).then((t=>{(0,a.Z)(`[Game] Fetched session identifiers in ${(Date.now()-e)/1e3}s`);const{MediaContainer:n}=t.data;(null==n?void 0:n.status)===u.qZ.Ok?N({peerID:n.peerID,sessionID:n.sessionID}):L({core:null==n?void 0:n.core,status:null==n?void 0:n.status,progress:null==n?void 0:n.progress})}),(t=>{const e=o().isCancel(t);a.Z.warn(`[Game] Session identifier request error; cancelled? ${e}`),e||L({status:u.qZ.UnknownFailure})})),()=>{t.cancel()}}),[g]),(0,i.useEffect)((()=>{var t;if(E){const e=new Error(function(t,e){const{core:n,progress:r,status:o}=t;switch(parseInt(o,10)){case u.qZ.AccountLinkageMissing:return(0,s.Z)("Parsec account not found. Ensure that your Plex account is linked to a Parsec account.");case u.qZ.SubscriptionRequired:return(0,s.Z)("An active Plex Arcade subscription is required for game playback.");case u.qZ.PlatformMissing:return(0,s.Z)("The core mapping file is missing the {platform} platform.",{platform:e});case u.qZ.PlatformCoreMappingMissing:return n?(0,s.Z)("The core mapping file is missing the {core} core for {platform}.",{core:n,platform:e}):(0,s.Z)("The core mapping file is missing a core for {platform}.",{platform:e});case u.qZ.PlatformCoreMissing:return n?(0,s.Z)("The core mapping file is missing the {core} core.",{core:n}):(0,s.Z)("The core mapping file is missing a core.");case u.qZ.TranscoderDied:return(0,s.Z)("The game transcoder exited unexpectedly.");case u.qZ.InvalidCoreMappingFile:return(0,s.Z)("The core mapping file is invalid.");case u.qZ.MissingCoreMappingFile:case u.qZ.PlatformCoreMappingFileMissingOrInvalid:return(0,s.Z)("The core mapping file is missing or invalid.");case u.qZ.SessionPeerNeverShowedUp:return(0,s.Z)("Unable to start a game session.");case u.qZ.TranscoderDownloading:return(0,s.Z)("The game transcoder is downloading; {progress}% complete.",{progress:r});case u.qZ.PlatformCoreDownloading:return n?(0,s.Z)("The {core} core for {platform} is downloading; {progress}% complete.",{core:n,platform:e,progress:r}):(0,s.Z)("A core for {platform} is downloading; {progress}% complete.",{platform:e,progress:r});case u.qZ.RomMissing:return(0,s.Z)("Media not found.");default:return(0,s.Z)("An unknown error occurred.")}}(E,r));e.category=function(t){switch(parseInt(t,10)){case u.qZ.AccountLinkageMissing:case u.qZ.SubscriptionRequired:return(0,s.Z)("Account");case u.qZ.PlatformMissing:case u.qZ.PlatformCoreMappingMissing:case u.qZ.PlatformCoreMissing:case u.qZ.InvalidCoreMappingFile:case u.qZ.MissingCoreMappingFile:case u.qZ.PlatformCoreMappingFileMissingOrInvalid:return(0,s.Z)("Game Setup");case u.qZ.TranscoderDied:case u.qZ.SessionPeerNeverShowedUp:case u.qZ.UnknownFailure:case u.qZ.TranscoderDownloading:case u.qZ.PlatformCoreDownloading:case u.qZ.RomMissing:return(0,s.Z)("Game Server");default:return(0,s.Z)("Unknown")}}(E.status),e.code=String(null!=(t=E.status)?t:-1),a.Z.error("[Game] Fatal error!",e),O(e)}}),[E,r,O]),(0,i.useEffect)((()=>{if(!_)return;const t=Date.now(),e=window.setInterval((()=>{const e=Date.now()-t,n=R.current+e,r=Math.floor(n/1e3);S(n),P(r)}),1e3);return w(-1),()=>{window.clearInterval(e)}}),[_,S,w,P]);const B=(0,c.Z)(f,m,h,t,e,p);return i.createElement(zt,{inputDevices:n,paused:d,peerID:null==C?void 0:C.peerID,platformTag:r,preventDefault:l,sessionID:null==C?void 0:C.sessionID,style:B,volume:y,onConnected:D,onError:O,onPause:v})}Ht.defaultProps={positionSeconds:0,volume:100};const Jt=Ht}}]);